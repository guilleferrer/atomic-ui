angular.module("ui.makelean.alerts",[]).run(["$rootScope","validationMessage","$timeout",function(a,b,c){a.alerts=[],a.closeAlert=function(b){a.alerts.splice(b,1)};var d=function(b){a.alerts.push(b),c(function(){a.alerts.pop()},3500)};a.$on("submit.error",function(){var a=b||"Oh snap! Change a few things up and try submitting again.";d({type:"danger",msg:a,keep:!1})}),a.$on("alert.show",function(a,b){d(b)}),a.$on("$stateChangeSuccess",function(){for(var b=a.alerts.length-1;b>=0;b--)a.alerts[b].keep||a.closeAlert(b)})}]),angular.module("ui.makelean.back",[]).directive("back",["$window",function(a){return function(b,c){c.on("click",function(){a.history.back()})}}]),angular.module("ui.makelean.compile",[],["$compileProvider",function(a){a.directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}])}]),angular.module("ui.makelean.confirm-url",["ui.bootstrap"]).directive("confirmUrl",["$http","$window","$modal",function(a,b,c){return function(d,e,f){var g=f.confirmUrl,h=f.confirmTitle,i=f.confirmMessage,j=f.confirmYes,k=f.confirmNo,l=f.confirmMethod||"delete",m=f.actionBtnClass||"btn-ml-danger",n="true"==f.followUrl;e.bind("click",function(e){e.preventDefault(),d.title=h,d.message=i,d.buttons=[{label:j,result:1,cssClass:m},{label:k,result:0,cssClass:"btn-ml-default"}];var f=c.open({scope:d,templateUrl:"template/dialog/message.html"});return d.close=function(a){f.close(a)},f.result.then(function(c){1===c&&(n===!0?b.location=g:a[l](g).success(function(a){d.$emit("apiEvent.ACTION_SUCCESS",a)}))}),!1})}}]),angular.module("ui.makelean.fbinvite",[]).factory("Facebook",function(){var a=function(a,b){FB.ui({method:"apprequests",filters:["app_non_users"],title:a.title,message:a.message},function(a){a&&b&&b(a)})};return{fb:function(){return FB},requestNonAppFriends:function(b,c){a(b,c)}}}).directive("fbinvite",["$http, Facebook",function(a,b){return{restrict:"A",link:function(a,c,d){var e=b;if(angular.isUndefined(d.fbinviteMessage))throw"fbinvite-message parameter is required";var f={title:d.fbinviteTitle,message:d.fbinviteMessage};c.on("click",function(){e.requestNonAppFriends(f)})}}}]),angular.module("ui.makelean.filter",["ui.makelean.tools"]).factory("filterHelper",["urlTools","$stateParams",function(a,b){function c(){return a.parseKeyValue(b.q)}function d(b){var c={};return Object.keys(b).length>0&&(c.q=a.toKeyValue(b,null)),c}return{searchToQuery:c,formToSearch:d}}]).directive("mlFilter",["$state","$stateParams","$location","filterHelper",function(a,b,c,d){return{link:function(e,f,g){var h=g.mlFilter,i=g.name;e.filter={show:!1,active:!1},e[i]={},e[h]=d.searchToQuery(),e[i]=e[h],Object.keys(e[i]).length>0&&(e.filter.active=!0),e.applyFilter=function(){if(e[i].$dirty!==!1){var a=d.formToSearch(e[i]);c.search(a),e.filter.show=!1,e.filter.active=!0,e.$emit("filterEvent.FILTER_CHANGE",a)}},e.resetFilter=function(){b.q=null,a.go(a.current,b,{reload:!1}),e[i]={},e[h]="",e.filter.show=!1,e.filter.active=!1}}}}]),angular.module("ui.makelean.full-screen",["ui.bootstrap","ui.makelean.viewport"]).directive("fullScreen",["$modal","viewport",function(a,b){return{scope:{images:"=fullScreen"},link:function(c,d){var e;d.on("click",function(){e=a.open({windowClass:"full-modal full-screen",templateUrl:"template/dialog/full-width.html",scope:c}),e.opened.then(function(){b.set("maximum-scale","2")}),e.result.then(function(){b.set("maximum-scale","1")})}),c.cancel=function(){e.close()}}}}]).run(["$templateCache",function(a){a.put("template/dialog/full-width.html",'<div class="modal-header"><button class="btn btn-link pull-right" data-ng-click="cancel()"><i class="ml-icon-30"></i></button></div><div class="modal-body testabit"><ul rn-carousel class="image"><li ng-repeat="image in images"><img ng-src="{{image}}"/></li></ul></div>')}]);var mod;mod=angular.module("infinite-scroll",[]),mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g,h,i,j;return b=angular.element(b),i=0,null!=f.infiniteScrollDistance&&d.$watch(f.infiniteScrollDistance,function(a){return i=parseFloat(a)}),j=!0,g=!1,null!=f.infiniteScrollDisabled&&d.$watch(f.infiniteScrollDisabled,function(a){return j=!a,j&&g?(g=!1,h()):void 0}),h=function(){var c,h,k,l;return l=b.height(),c=e.offset().top+e.height(),h=c-l,k=20*i>=h,k&&j?a.$$phase?d.$eval(f.infiniteScroll):d.$apply(f.infiniteScroll):k?g=!0:void 0},e.parents(".scroller").on("scroll",h),d.$on("$destroy",function(){return e.parents(".scroller").off("scroll",h)}),c(function(){return f.infiniteScrollImmediateCheck?d.$eval(f.infiniteScrollImmediateCheck)?h():void 0:h()},0)}}}]),angular.module("ui.makelean.lists",["ui.makelean.pager","infinite-scroll","tpl/list/paged-list.html"]).directive("list",["Pager","$rootScope",function(a,b){return{restrict:"E",templateUrl:"tpl/list/paged-list.html",replace:!0,transclude:!0,link:function(c,d,e){c.listClass=e.listClass||"list-group",c.listCache=e.$attr.listNoCache?!1:!0;var f=c.$eval(e.apiQuery)||{};c.pager=new a(e.apiUrl,f),b.$on("searchEvent.SEARCH_CHANGE",function(b,d,g){angular.extend(f,g),c.pager=new a(e.apiUrl,f),c.pager.nextPage()})}}}]).directive("listItem",function(){return{restrict:"E",replace:!0,templateUrl:function(a,b){return b.itemTplUrl||"/tpl/list/list-item.html"}}}),angular.module("tpl/list/paged-list.html",[]).run(["$templateCache",function(a){a.put("tpl/list/paged-list.html",'<div class=\'paged-list-container\'><ul data-ng-class="listClass" data-infinite-scroll="pager.nextPage(angular.noop, listCache)" data-infinite-scroll-distance="1" data-ng-transclude></ul>'+"<span id=\"spinner-mini\" data-us-spinner=\"{lines: 13, length: 0, width: 5, radius: 14, corners: 1, rotate: 0, direction: 1, color: '#000', speed: 1.7, trail: 100, shadow: false, hwaccel: false, className: 'spinner', zIndex: 2e9, top: 'auto', left: 'auto' }\"></span></div>")}]),angular.module("ui.makelean.mail",[]).directive("mailto",function(){return{restrict:"A",scope:{mailto:"="},link:function(a,b,c){var d=c.mailto,e=c.mailtoSubject,f=c.mailtoContent;b.bind("click",function(){window.location="mailto:"+d+"?subject="+e+"&body="+encodeURIComponent(f)}),a.$watch("mailto",function(a){a&&(d=a)})}}}),angular.module("filters.makelean.nl2br",[]).filter("nl2br",[function(){return function(a,b){if(a){var b=b||!0,c=b?"<br />":"<br>",a=(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+c+"$2");return a}return""}}]),angular.module("ui.makelean.pager",[]).provider("pagerCache",function(){this.$get=["$cacheFactory",function(a){return a("pager")}]}).provider("Pager",function(){var a=1;this.setInitialPage=function(b){a=b},this.$get=["$http","$rootScope","pagerCache",function(b,c,d){function e(b,c,d){this.id=(new Date).getTime(),this.search=c||{},this.middleware=d||function(a){return a},this.url=b,this.page=a,this.finished=!1,this.busy=!1,this.showNoResults=!1,this.results=[],this.nbResults=0,this.nbUnread=0}function f(a,b){var c=[];for(var d in a){var e=b?b+"["+d+"]":d,g=a[d];c.push("object"==typeof g?f(g,e):encodeURIComponent(e)+"="+encodeURIComponent(g))}return c.join("&")}return e.prototype.nextPage=function(a,e){var g={};if(e!==!1&&(g.cache=d),!this.busy&&!this.finished){this.busy=!0;var h=this.url;this.search=angular.extend(this.search,{page:this.page});var i=f(this.search);h+=i?"?"+i:"";var j=this;b.get(h,g).then(function(b){var d=b.data;return j.busy=!1,j.nbResults=d.nbResults,j.nbUnread+=d.nbUnread,j.showNoResults=0==d.results.length,angular.forEach(d.results,function(a){j.results.push(j.middleware(a))}),0==d.nbPages&&0==j.results.length&&c.$broadcast("pager.no_results",j.id),angular.isFunction(a)&&a(j),c.$broadcast("pager.page_loaded",j.page,j.results),d.nbPages==j.page||0==d.results.length?(j.finished=!0,void c.$broadcast("pager.last_page")):void(j.page+=1)})}},e}]}),angular.module("ui.makelean.search",["ui.makelean.pager"]).directive("searchDispatcher",["$timeout",function(a){return{link:function(b,c,d){function e(a){var c={};c[g]=a,b.$emit("searchEvent.SEARCH_CHANGE",a,c)}var f,g=d.searchField;b.$watch(d.ngModel,function(b,c){b!==c&&(a.cancel(f),f=a(function(){e(b)},1e3))})}}}]).directive("searchPager",["$timeout","$rootScope","Pager",function(a,b,c){return{scope:{searchParams:"@",pager:"=searchPager"},require:"ngModel",link:function(d,e,f){function g(a,b,e){b&&(e.name=b),d.pager=new c(d.pager.url,e),d.pager.nextPage()}var h;d.$watch(f.ngModel,function(c,e){c!==e&&(a.cancel(h),h=a(function(){b.$broadcast("search.change",c,d.$eval(d.searchParams))},1e3))}),d.$on("search.change",g)}}}]).directive("search",["$timeout","$rootScope","$resource",function(a,b,c){return{restrict:"EA",templateUrl:function(a,b){return b.templateUrl||"/tpl/search.html"},scope:{searchParams:"@",searchUrl:"@","class":"@",inputClass:"@",listClass:"@",placeholder:"@",noResultMessage:"@"},replace:!0,transclude:!0,controller:function(b,d){function e(a,d,e){d&&(e.name=d,c(b.searchUrl,e).get(function(a){b.results=a.results,b.showNoresult=0===b.results.length}))}b.results=[],b.search="",b.showNoresult=!1;var f,g=b.$eval(b.searchParams)||{};b.$watch("search",function(c,d){c!==d&&(a.cancel(f),f=a(function(){b.$emit("search.change",c,g)},500)),c||(b.showNoresult=!1,b.results=[])}),d.$on("search.change",e)}}}]).directive("searchItem",function(){return{restrict:"EA",templateUrl:"/tpl/search/item.html",require:"^search",replace:!0}}),function(a){"use strict";a.module("angulartics.ga",["angulartics"]).config(["$analyticsProvider",function(a){var b="/";a.registerPageTrack(function(a){b=a,window.ga&&ga("send","pageview",a)}),a.registerEventTrack(function(a,c){window.ga&&window.ga("send","event",c.category,a,c.label,{page:b})})}])}(angular),angular.module("ui.makelean.testabit",["angulartics","angulartics.ga","ui.bootstrap","ui.router"]).value("testabitYesText").value("testabitNoText").provider("testabit",function(){var a=[],b=["silent","modal"],c=!1;this.setDebugMode=function(a){c=a},this.setCategories=function(b){if(!angular.isArray(b))throw"Categories for testabit should be an array";a=b},this.$get=["$log","$analytics",function(d,e){function f(a,b,f,g){var h={category:a,label:f};""!==g&&(h.value=g),c&&d.log("Testabit.eventTrack : ","action: ",b,"/ category: ",h.category,"/ label: ",h.label),e.eventTrack(b,h)}var g={};return angular.extend(g,{eventTrack:f,allowedCategories:a,allowedTypes:b,debugMode:c}),g}]}).directive("testabit",["testabit","$log","$modal","testabitYesText","testabitNoText",function(a,b,c,d,e){function f(a){return"testabit error : "+a}function g(c){var d=!1;return-1===a.allowedTypes.indexOf(c.testabit)&&(b.log(f("Invalid testabit parameter '"+c.testabitCategory+"' . The testabit type should be one of these : "),a.allowedTypes),d=!0),"modal"===c.testabit&&(c.testabitModalTitle||(b.log(f("Invalid modal title '"+c.testabitModalTitle+"' . You have configured testabit type modal, so you must introduce the title of the modal")),d=!0),c.testabitModalMessage||(b.log(f("Invalid modal message '"+c.testabitModalMessage+"' . You have configured testabit type modal, so you must introduce the message of the modal")),d=!0)),-1===a.allowedCategories.indexOf(c.testabitCategory)&&(b.log(f("Invalid category '"+c.testabitCategory+"' . The category should be one of these : "),a.allowedCategories),d=!0),c.testabitAction||(b.log(f("Invalid action '"+c.testabitAction+"'")),d=!0),c.testabitLabel||(b.log(f("Invalid label '"+c.testabitLabel+"'")),d=!0),d?!1:{category:c.testabitCategory,action:c.testabitAction,label:c.testabitLabel,value:c.testabitValue}}return function(b,f,h){var i=h.testabitYesText||d,j=h.testabitNoText||e;a.debugMode&&f.css("border","2px dashed white");var k=function(){var b=g(h);if(b===!1)return void(a.debugMode&&f.css("border","2px dashed red"));if("modal"===h.testabit){var d=[{label:j,result:0,cssClass:"btn-ml-default"},{label:i,result:1,cssClass:"btn-ml-primary"}],e=c.open({templateUrl:"template/dialog/testabit-message.html",controller:"MessageBoxController",resolve:{model:function(){return{title:h.testabitModalTitle,message:h.testabitModalMessage,buttons:d}}}});e.result.then(function(c){var d=parseInt(c)>0?"positive_vote":"negative_vote";a.eventTrack(b.category,b.action+"."+d,b.label,c)})}else a.eventTrack(b.category,b.action,b.label,b.value)};f.bind("click",function(){b.$apply(k)})}}]).controller("MessageBoxController",["$scope","$modalInstance","model",function(a,b,c){a.close=function(a){b.close(a)},a.title=c.title,a.message=c.message,a.buttons=c.buttons}]),angular.module("ui.makelean.tools",[]).factory("urlTools",function(){function a(b,c){var d=[];for(var e in b){var f=c?c+"["+e+"]":e,g=b[e];d.push("object"==typeof g?a(g,f):encodeURIComponent(f)+"="+encodeURIComponent(g))}return d.join("&")}function b(a){try{return decodeURIComponent(a)}catch(b){}}function c(a){var c,d,e={};return angular.forEach((a||"").split("&"),function(a){if(a&&(c=a.split("="),d=b(c[0]),angular.isDefined(d))){var f=angular.isDefined(c[1])?b(c[1]):!0;e[d]?isArray(e[d])?e[d].push(f):e[d]=[e[d],f]:e[d]=f}}),e}return{toKeyValue:a,parseKeyValue:c}}),angular.module("ui.makelean.viewport",[]).factory("viewport",function(){function a(){var a=angular.element('meta[name="viewport"]').attr("content");return b(a)}function b(a){var b={},c=a.replace(/ /g,"").split(",");return angular.forEach(c,function(a){var b=a.split("=");this[b[0]]=b[1]},b),b}function c(a){var b=[];return angular.forEach(a,function(a,c){b.push(c+"="+a)}),b.join(",")}function d(a,b){e[a]=b;var d=c(e);angular.element('meta[name="viewport"]').attr("content",d)}var e=a();return{get:a,set:d}}),angular.module("filters.makelean.truncate",[]).filter("truncate",function(){return function(a,b,c){return a?(isNaN(b)&&(b=100),void 0===c&&(c="..."),a.length<=b||a.length-c.length<=b?a:String(a).substring(0,b-c.length)+c):""}}),angular.module("filters.makelean.urlencode",[]).filter("urlencode",[function(){return function(a){return encodeURIComponent(a)}}]),angular.module("ui.makelean.user_advice",["ui.router"]).directive("userAdvice",["$http, $document, $rootScope",function(a,b,c){return{link:function(d,e,f){var g=f.userAdvice,h="/api/advices/"+g+"/disable",i=function(){d.$apply(function(){a.get(h),b.find(".advice-"+g).remove(),c.$broadcast("advice.disable",g)})};e.bind("click",i)}}}]),angular.module("ui.makelean.whatsapp",["adaptive.detection"]).directive("whatsapp",["$window","$detection","$rootScope",function(a,b){return{restrict:"A",link:function(c,d,e){b.isiOS()?d.bind("click",function(){a.location="whatsapp://send?text="+encodeURIComponent(e.whatsapp)}):d.hide()}}}]);